"use strict";
//!-----------------Определение типа устройства на котором открыт сайт--------------------------------------------------------------
const isMobile={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows()}};isMobile.any()?document.body.classList.add("_touch"):document.body.classList.add("_pc");
//!--------------------------------------Открытие подменю и меню на тачпаде--------------------------------------------------------------------
const blockWsubmenu=document.querySelector(".header__crumb-w-sublist span"),submenu=document.querySelector(".header__sublist"),menuIcon=document.querySelector(".header__menu-icon"),headerCrumbs=document.querySelector(".header__crumbs");document.body.classList.contains("_touch")&&(headerCrumbs.classList.add("_touchme"),blockWsubmenu.addEventListener("click",(function(e){submenu.classList.toggle("_open")})),menuIcon.addEventListener("click",(e=>{menuIcon.classList.toggle("_open"),headerCrumbs.classList.toggle("_open"),document.body.classList.toggle("_lock")})));
//!--------------------------------------Trainers Likes and hearts--------------------------------------------------------------------
const trainHearts=document.querySelectorAll(".trainer__icons-left svg:nth-child(1)"),trainLikes=document.querySelectorAll(".trainer__icons-left svg:nth-child(2)");trainHearts.forEach(((e,t)=>{e.addEventListener("click",(()=>{e.classList.toggle("_color")}))})),trainLikes.forEach(((e,t)=>{e.addEventListener("click",(()=>{e.classList.toggle("_color")}))})),
//!-----------------------------Trainers slider-swiper-----------------------------------------------------
new Swiper(".trainers",{loop:!0,navigation:{nextEl:".trainers-swiper-button-next",prevEl:".trainers-swiper-button-prev"},grabCursor:!0,keyboard:{enabled:!0,onlyInViewport:!0},slidesPerView:2,watchOverflow:!0,slidesPerGroup:1,speed:500,preloadImages:!1,lazy:{loadOnTransitionStart:!0,loadPrevNext:!0},watchSlidesProgress:!0,watchSlidesVisibility:!0,ally:{enabled:!0},grid:{rows:1}}),
//!------------------------------------------------Gallery swiper---------------------------------------
new Swiper(".gallery-swiper",{navigation:{nextEl:".gallery-button-next",prevEl:".gallery-button-prev"},simulateTouch:!0,grabCursor:!0,keyboard:{enabled:!0,onlyInViewport:!0},mousewheel:{sensitivity:1,eventsTarget:".gallery-item"},watchOverflow:!0,spaceBetween:5,slidesPerGroup:3,slidesPerView:3,grid:{columns:3,rows:2},autoplay:{delay:4e3,disableOnInteraction:!0,pauseOnMouseEnter:!0},speed:1800,breakpoints:{320:{slidesPerView:1,slidesPerGroup:1,grid:{columns:1,rows:1}},430:{slidesPerView:2,slidesPerGroup:2},576:{slidesPerView:3,slidesPerGroup:3}},watchSlidesProgress:!0,watchSlidesVisibility:!0,ally:{enabled:!0}}),
//!--------------------------Twitter swiper------------------------------------------------------------------------------
new Swiper(".twitter-swiper",{loop:!0,simulateTouch:!1,keyboard:{enabled:!0,onlyInViewport:!0},mousewheel:{sensitivity:1,eventsTarget:".twitter__slide"},watchOverflow:!0,autoplay:{delay:4e3,pauseOnMouseEnter:!0},speed:800,effect:"fade",fadeEffect:{crossFade:!0},ally:{enabled:!0}}),
//!-----------------------------------------------------------------------------Плавный скролл-------------------------------------------------------
document.querySelectorAll('a[href^="#"]').forEach((e=>{e.addEventListener("click",(function(e){e.preventDefault();let t=this.getAttribute("href"),o=document.getElementById(t.substring(1)).getBoundingClientRect().top;window.scrollTo({top:o+window.scrollY,behavior:"smooth"})}))}));
//!----------------------------------------------------------------------Popups------------------------------------------------------------------
const popupLinks=document.querySelectorAll(".popup__link"),popupCloseIcon=document.querySelectorAll(".close-popup"),popups=document.querySelectorAll(".popup"),body=document.querySelector("body"),lockPadding=document.querySelectorAll(".lock-padding");function openPopup(e){const t=document.querySelector(".popup.open");t?(closePopup(t),e.classList.add("open")):(e.classList.add("open"),bodyLock())}function bodyLock(){const e=window.innerWidth-document.querySelector(".wrapper").offsetWidth+"px";body.style.paddingRight=e,lockPadding.forEach((t=>{t.style.paddingRight=e})),body.classList.add("_lock")}function bodyUnlock(){body.style.paddingRight="0px",lockPadding.forEach((e=>{e.style.paddingRight="0px"})),body.classList.remove("_lock")}function closePopup(e){e.classList.remove("open"),bodyUnlock()}
//!---------------------------------------------------------Валидация и отправка форм------------------------------------------------
//! Маска
document.addEventListener("click",(()=>{if(event.target.closest(".popup__link")){let e=event.target.closest(".popup__link").getAttribute("href").replace("#","");openPopup(document.getElementById(e)),event.preventDefault()}})),document.addEventListener("click",(()=>{event.target.closest(".close-popup")&&(closePopup(event.target.closest(".popup")),event.preventDefault())})),popups.forEach((e=>{e.addEventListener("click",(()=>{event.target.closest(".popup__content")||closePopup(event.target.closest(".popup"))}))})),document.addEventListener("keydown",(()=>{if("Escape"===event.code){closePopup(document.querySelector(".popup.open"))}}));let inpPhoneNumber=document.querySelectorAll('input[type = "tel"]'),im=new Inputmask("+7 (999) 999-99-99");im.mask(inpPhoneNumber);
//!
const thanksWindow=document.querySelector(".thanks-you-window");let validateForms=function(e,t,o,n,s){new window.JustValidate(e,{rules:t,messages:o,submitHandler:async function(e){let t=new FormData(e),o=await fetch("php/sendmail.php",{method:"POST",body:t});if(o.ok){await o.json();console.log(n),n.classList.add("_visible"),setTimeout(n.classList.remove("_visible"),2e3),e.reset()}else alert("Ошибка")},colorWrong:"red"})};validateForms(".popup-callback1",{num1:{required:!0,phone:!0}},{num1:{required:"Введите номер телефона",phone:"Неправильный номер"}},thanksWindow,"send goal"),validateForms(".popup-callback2",{num2:{required:!0,phone:!0}},{num2:{required:"Введите номер телефона",phone:"Неправильый номер"}},thanksWindow,"send goal"),validateForms(".footer__email-form",{email:{required:!0,email:!0}},{email:{required:"Введите email",email:"Введите существующий email"}},thanksWindow,"send goal");